

```mermaid
graph TD
    %% å®šç¾©æ¨£å¼
    classDef user fill:#f9f,stroke:#333,stroke-width:2px;
    classDef ui fill:#e1f5fe,stroke:#0277bd,stroke-width:2px;
    classDef logic fill:#fff9c4,stroke:#fbc02d,stroke-width:2px;
    classDef db fill:#e0e0e0,stroke:#616161,stroke-width:2px;
    classDef api fill:#ffe0b2,stroke:#f57c00,stroke-width:2px;

    %% ç¯€é»å®šç¾©
    User((ä½¿ç”¨è€…)):::user
    
    subgraph Streamlit_App [Streamlit Application]
        UI[ğŸ’» å‰ç«¯ä»‹é¢ UI]:::ui
        Auth[ğŸ” èªè­‰æ¨¡çµ„<br/>Login/Signup]:::logic
        Session[ğŸ’¾ Session State<br/>ç‹€æ…‹ç®¡ç†]:::logic
        
        subgraph Core_Features [æ ¸å¿ƒåŠŸèƒ½]
            AI_Planner[ğŸ¤– AI è¡Œç¨‹è¦åŠƒ<br/>Gemini Pro]:::logic
            Manual_Planner[ğŸ—ºï¸ æ‰‹å‹•è¦åŠƒ<br/>è³‡æ–™åº«æœå°‹]:::logic
            Weather_Mod[â˜ï¸ å¤©æ°£é å ± &<br/>ç©¿æ­å»ºè­°]:::logic
        end
        
        Output[ğŸ“Š è¼¸å‡ºå‘ˆç¾<br/>HTMLå¡ç‰‡/åœ–è¡¨/æ–‡å­—æª”]:::ui
    end

    subgraph Data_Storage [æœ¬åœ°è³‡æ–™å­˜å„²]
        CSV[(taiwan_attractions.csv<br/>æ™¯é»è³‡æ–™åº«)]:::db
        UserDB[(users_db.json<br/>ä½¿ç”¨è€…è³‡æ–™)]:::db
        HistDB[(history_db.json<br/>è¡Œç¨‹æ­·å²)]:::db
    end

    subgraph External_Services [å¤–éƒ¨ API æœå‹™]
        GeminiAPI[âœ¨ Google Gemini API<br/>LLM ç”Ÿæˆ]:::api
        OpenMeteo[â˜” Open-Meteo API<br/>å¤©æ°£è³‡è¨Š]:::api
        GoogleMaps[ğŸ“ Google Maps<br/>å°èˆªé€£çµ]:::api
    end

    %% é—œä¿‚é€£ç·š
    User -->|ç™»å…¥/è¨»å†Š| Auth
    User -->|è¼¸å…¥éœ€æ±‚/æ“ä½œ| UI
    UI --> Session
    
    Auth <-->|è®€å¯«| UserDB
    
    UI -->|AI æ¨¡å¼| AI_Planner
    UI -->|æ‰‹å‹•æ¨¡å¼| Manual_Planner
    UI -->|æŸ¥çœ‹ç´€éŒ„| HistDB
    
    AI_Planner -->|Prompt| GeminiAPI
    AI_Planner -->|æŸ¥è©¢| CSV
    Manual_Planner -->|æŸ¥è©¢| CSV
    
    AI_Planner -->|å„²å­˜çµæœ| HistDB
    Manual_Planner -->|å„²å­˜çµæœ| HistDB
    
    AI_Planner --> Weather_Mod
    Manual_Planner --> Weather_Mod
    Weather_Mod -->|æŸ¥è©¢ç¶“ç·¯åº¦| OpenMeteo
    
    Weather_Mod --> Output
    AI_Planner --> Output
    Manual_Planner --> Output
    
    Output -->|ç”Ÿæˆé€£çµ| GoogleMaps
